[Train] Epoch 1:   0%|                                                                                                                                                                    | 0/38 [00:21<?, ?it/s]
Traceback (most recent call last):
  File "D:\2-postdoc\fun_stuff\2-Satheesh\open_clip\train_2.py", line 80, in <module>
    image_features = model.get_image_features(**image_inputs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\transformers\models\clip\modeling_clip.py", line 1304, in get_image_features
    vision_outputs = self.vision_model(
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\transformers\models\clip\modeling_clip.py", line 1096, in forward
    encoder_outputs = self.encoder(
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\transformers\models\clip\modeling_clip.py", line 876, in forward
    layer_outputs = encoder_layer(
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\transformers\models\clip\modeling_clip.py", line 617, in forward
    hidden_states = self.mlp(hidden_states)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\transformers\models\clip\modeling_clip.py", line 573, in forward
    hidden_states = self.activation_fn(hidden_states)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\transformers\activations.py", line 96, in forward
    return input * torch.sigmoid(1.702 * input)
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "D:\2-postdoc\fun_stuff\2-Satheesh\open_clip\train_2.py", line 80, in <module>
    image_features = model.get_image_features(**image_inputs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\transformers\models\clip\modeling_clip.py", line 1304, in get_image_features
    vision_outputs = self.vision_model(
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\transformers\models\clip\modeling_clip.py", line 1096, in forward
    encoder_outputs = self.encoder(
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\transformers\models\clip\modeling_clip.py", line 876, in forward
    layer_outputs = encoder_layer(
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\transformers\models\clip\modeling_clip.py", line 617, in forward
    hidden_states = self.mlp(hidden_states)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\transformers\models\clip\modeling_clip.py", line 573, in forward
    hidden_states = self.activation_fn(hidden_states)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\28098\miniconda3\envs\llava\lib\site-packages\transformers\activations.py", line 96, in forward
    return input * torch.sigmoid(1.702 * input)
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
